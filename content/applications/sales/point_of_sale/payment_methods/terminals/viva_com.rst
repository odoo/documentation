========
Viva.com
========

**Viva.com** is a payment service that offers payment solutions through the **viva.com Terminal**
app for :doc:`physical <../terminals>` and virtual terminals.

.. note::
   - Viva.com payment terminals do not require an :doc:`IoT Box </applications/general/iot>` to
     operate.
   - `Many European countries <https://developer.viva.com/about-viva/>`_ support the use of Viva.com
     payment terminals.
   - The viva.com Terminal app turns a smartphone with an NFC chip into a `payment terminal
     <https://www.viva.com/en-gb/blog/tap-on-phone-turn-your-phone-into-a-mobile-card-reader>`_.

.. important::
   Odoo only supports the Euro currency with viva.com.

.. seealso::
   - `List of supported terminals <https://www.vivawallet.com/shop/terminals/terminals-4>`_
   - `List of supported payment methods <https://developer.viva.com/payment-methods/>`_

.. _viva/configuration:

Viva.com configuration
======================

To configure a viva.com terminal, go to the `Viva.com website <https://www.viva.com>`_, create an
account, and then follow these steps:

#. On the viva.com dashboard, go to :menuselection:`Settings --> API Access --> General`.
#. Copy the `Merchant ID and API key
   <https://developer.viva.com/getting-started/find-your-account-credentials/merchant-id-and-api-key/>`_.
#. Copy the `Client ID and the generated Client secret (POS API credentials)
   <https://developer.viva.com/getting-started/find-your-account-credentials/pos-apis-credentials/>`_.
#. Download the viva.com Terminal app on a device, then generate and copy the `activation code
   <https://euhelp.viva.com/en/articles/5316775-how-do-i-activate-the-viva-com-terminal>`_.
#. On the viva.com dashboard, go to :menuselection:`Sales --> Sales Transactions --> Physical
   Payments --> Card Terminals`.
#. Create a new `card terminal and paste the activation code
   <https://euhelp.viva.com/en/articles/5316775-how-do-i-activate-the-viva-com-terminal>`_.
#. Copy the :guilabel:`Terminal ID` generated by the terminal activation.

.. warning::
   The POS API credentials are only displayed once. Make sure to keep a copy to secure them.

.. note::
   - The POS API credentials are for APIs that use Basic Authentication, including those for Android
     and iOS POS activation and the `Cloud Terminal API
     <https://developer.viva.com/apis-for-point-of-sale/card-terminals-devices/rest-api/>`_.

Odoo POS configuration
======================

To connect the viva.com terminal with Odoo Point of Sale, follow these steps:

#. Go to :menuselection:`Point of Sale --> Configuration --> Settings`, scroll down to the
   :guilabel:`Payment Terminals` section, enable the :guilabel:`Viva Wallet` terminal, and click
   :guilabel:`Save`.
#. Go to :menuselection:`Point of Sale --> Configuration --> Payment Methods` and :doc:`create a
   payment method <../../payment_methods>`.
#. Set the :guilabel:`Journal` field to :guilabel:`Bank`.
#. Set the :guilabel:`Integration` field to :guilabel:`Terminal`.
#. Set the :guilabel:`Integrate with` field to :guilabel:`Viva Wallet`.
#. Paste the copied information from :ref:`viva.com <viva/configuration>` into the corresponding
   fields:

   - :guilabel:`Merchant ID`
   - :guilabel:`API Key`
   - :guilabel:`Client ID`
   - :guilabel:`Client secret`
   - :guilabel:`Terminal ID`

#. Save the form and copy the generated webhook URL from the :guilabel:`Viva Wallet Webhook
   Endpoint` field.
#. Go to the :ref:`viva.com <viva/configuration>` account and paste the webhook URL into the
   `corresponding field
   <https://developer.viva.com/webhooks-for-payments/transaction-payment-created/>`_.
#. In Odoo, access the :ref:`relevant point of sale settings <configuration/settings>`, scroll down
   to the :guilabel:`Payment` section, and add the created payment method in the :guilabel:`Payment
   Methods` field.
#. Click :guilabel:`Save`.
